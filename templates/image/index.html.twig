{% extends 'base_admin.html.twig' %}

{% block title %}Image index{% endblock %}

{% block body %}
    <h1>Image index</h1>

    <table class="table table-responsive">
        <thead>
            <tr>
                <th>Id</th>
                <th>Hash</th>
                <th>Path</th>
                <th>MimeType</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for image in images %}
            <tr>
                <td>{{ image.id }}</td>
                <td>{{ image.hash }}</td>
                <td>{{ image.path }}</td>
                <td>{{ image.mimeType }}</td>
                <td>
                    <a href="#" class="copy-link" data-link="{{ url('image_show', {'image': image.id}) }}">Copy Link</a>
                    <a href="{{ path('app_image_show', {'id': image.id}) }}">show</a>
                    <a href="{{ path('app_image_edit', {'id': image.id}) }}">edit</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="5">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <a href="{{ path('app_image_new') }}">Create new</a>
    <script>
        document.querySelectorAll('.copy-link').forEach(button => {
            button.addEventListener('click', async (e) => {
                e.preventDefault();

                const linkToCopy = button.dataset.link; // get the link from the data attribute

                try {
                    await navigator.clipboard.writeText(linkToCopy);
                    button.textContent = 'Copied!';
                    setTimeout(() => button.textContent = 'Copy link', 1500);
                } catch (err) {
                    console.error('Failed to copy:', err);
                }
            });
        });
    </script>
{% endblock %}
